/**
 * Session type definitions for WebSocket/enhanced session functionality
 * Extracted from enhanced-session.ts during Phase 1 refactoring
 */

export interface SessionOptions {
  projectRoot?: string;
  workspaceDir?: string;
  sessionId?: string;
  timeout?: number;
}

export interface SessionState {
  id: string;
  projectRoot: string;
  workspaceDir: string;
  isActive: boolean;
  lastActivity: Date;
  connectionCount: number;
}

export interface SessionContext {
  session: SessionState;
  options: SessionOptions;
  cleanup: () => Promise<void>;
}

export interface SessionManager {
  createSession: (options: SessionOptions) => Promise<SessionContext>;
  getSession: (sessionId: string) => SessionContext | null;
  destroySession: (sessionId: string) => Promise<void>;
  listSessions: () => SessionState[];

// Enhanced client session for FUSE integration
export interface EnhancedClientSession {
  id: string;
  globalProjectId: string; // Server-generated unique ID for true isolation
  workspaceId: string; // Isolated workspace identifier
  fuseMount?: string; // FUSE mount point path
  workspaceDir?: string; // Isolated working directory for LSP servers
}

export interface WorkspaceInfo {
  workspaceId: string;
  workspaceDir: string;
  fuseMount: string;
  sessionId: string;
  globalProjectId: string;
  createdAt: Date;
  lastAccessed: Date;
}

export interface FuseOperationRequest {
  method: 'fuse/read' | 'fuse/write' | 'fuse/stat' | 'fuse/readdir' | 'fuse/open' | 'fuse/release';
  path: string;
  flags?: number;
  data?: Buffer;
  correlationId: string;
}

export interface FuseOperationResponse {
  success: boolean;
  data?: Buffer | any;
  error?: string;
  errno?: number;
  correlationId: string;
}
