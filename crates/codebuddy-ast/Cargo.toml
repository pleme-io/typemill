[package]
name = "codebuddy-ast"
edition = "2021"
description = "AST parsing and transformation for Codeflow Buddy"
license = "MIT"

[dependencies]
codebuddy-foundation = { path = "../codebuddy-foundation" }
cb-plugin-api = { path = "../cb-plugin-api" }
serde = { workspace = true }
serde_json = { workspace = true }
thiserror = { workspace = true }
chrono = { version = "0.4", features = ["serde"] }
async-trait = { workspace = true }
# LSP types for refactoring integration
lsp-types = "0.97"
# Enhanced parsing with regex (kept for fallback)
regex = "1.10"
# Rust AST parsing
syn = { version = "2.0", features = ["full", "extra-traits", "visit"] }
quote = "1.0"
# Additional utilities
petgraph = "0.6" # For dependency graph analysis
pathdiff = "0.2" # For calculating relative paths
tokio = { workspace = true } # For async file operations in import_updater
tracing = { workspace = true } # For logging in import_updater
dashmap = { workspace = true } # For thread-safe concurrent caching
toml_edit = "0.23" # For parsing and modifying Cargo.toml files
mill-config = { path = "../mill-config" }

[features]
# Language features are preserved for backward compatibility but do not enable dependencies
# codebuddy-ast now uses capability traits from cb-plugin-api instead of direct plugin dependencies
default = []
lang-rust = []
lang-typescript = []
lang-markdown = []

[dev-dependencies]
tempfile = "3.0"
cb-lang-rust = { path = "../cb-lang-rust", default-features = false }
