[package]
name = "cb-test-support"
version = "1.0.0-rc4"
edition = "2021"
license.workspace = true
publish = false

[dependencies]
tokio = { workspace = true }
serde = { workspace = true }
serde_json = { workspace = true }
tempfile = { workspace = true }
async-trait = { workspace = true }
uuid = { workspace = true }
mockall = { workspace = true }
once_cell = "1.19"
shellexpand = "3.1"
chrono = { version = "0.4", features = ["serde"] }
libc = "0.2"
codebuddy-foundation = { path = "../codebuddy-foundation" }
cb-plugin-api = { path = "../cb-plugin-api" }
cb-handlers = { path = "../cb-handlers", default-features = false, features = ["refactor-all"] }
cb-services = { path = "../cb-services", default-features = false }

# Benchmark dependencies (merged from cb-bench)
cb-server = { path = "../cb-server", default-features = false }
simd-json = "0.16"
codebuddy-plugin-system = { path = "../codebuddy-plugin-system", default-features = false, features = ["runtime"] }
codebuddy-config = { path = "../codebuddy-config" }
codebuddy-ast = { path = "../codebuddy-ast", default-features = false }

[dev-dependencies]
criterion = { version = "0.5", features = ["html_reports", "async_tokio"] }

# Plugin bundle - provides all language plugins via auto-discovery
# Linked via extern crate declaration in test modules
codebuddy-plugin-bundle = { path = "../codebuddy-plugin-bundle", features = ["lang-rust", "lang-typescript", "lang-markdown", "lang-toml", "lang-yaml"] }

# Benchmarks (merged from cb-bench)
[[bench]]
name = "dispatch_benchmark"
harness = false

[[bench]]
name = "serialization_benchmark"
harness = false

[[bench]]
name = "forwarding_benchmark"
harness = false

[[bench]]
name = "optimization_benchmark"
harness = false
