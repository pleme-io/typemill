[package]
name = "mill-test-support"
version = "1.0.0-rc4"
edition = "2021"
license.workspace = true
publish = false

[dependencies]
tokio = { workspace = true }
serde = { workspace = true }
serde_json = { workspace = true }
tempfile = { workspace = true }
async-trait = { workspace = true }
uuid = { workspace = true }
mockall = { workspace = true }
once_cell = "1.19"
shellexpand = "3.1"
chrono = { version = "0.4", features = ["serde"] }
libc = "0.2"
mill-foundation = { path = "../mill-foundation" }
mill-plugin-api = { path = "../mill-plugin-api" }
mill-services = { path = "../mill-services", default-features = false }

# Benchmark dependencies (merged from cb-bench)
mill-server = { path = "../mill-server", default-features = false }
simd-json = "0.16"
mill-plugin-system = { path = "../mill-plugin-system", default-features = false, features = ["runtime"] }
mill-config = { path = "../mill-config" }
mill-ast = { path = "../mill-ast", default-features = false }
mill-handlers = { path = "../mill-handlers", default-features = false, features = ["refactor-all"] }

[dev-dependencies]
criterion = { version = "0.5", features = ["html_reports", "async_tokio"] }

# Plugin bundle - provides all language plugins via auto-discovery
# Linked via extern crate declaration in test modules
mill-plugin-bundle = { path = "../mill-plugin-bundle", features = ["lang-rust", "lang-typescript", "lang-markdown", "lang-toml", "lang-yaml"] }

# Benchmarks (merged from cb-bench)
[[bench]]
name = "dispatch_benchmark"
harness = false

[[bench]]
name = "serialization_benchmark"
harness = false

[[bench]]
name = "forwarding_benchmark"
harness = false

[[bench]]
name = "optimization_benchmark"
harness = false
